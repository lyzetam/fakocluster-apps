<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name"> | My New Hugo Site</title>
<meta property="og:title" content=" | My New Hugo Site" />
<meta name="twitter:title" content=" | My New Hugo Site" />
<meta itemprop="name" content=" | My New Hugo Site" />
<meta name="application-name" content=" | My New Hugo Site" />
<meta property="og:site_name" content="" />

<meta name="description" content="">
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />

  <link rel="alternate" hreflang="en" href="http://localhost:1313/pages/services/kube-bench/readme/" title="" />






<meta name="generator" content="Hugo 0.148.2">

    
    <meta property="og:url" content="http://localhost:1313/pages/services/kube-bench/readme/">
  <meta property="og:site_name" content="My New Hugo Site">
  <meta property="og:title" content="My New Hugo Site">
  <meta property="og:description" content="Kube-bench - Kubernetes Security Benchmark Scanner Overview Kube-bench is an automated security compliance scanner deployed in the Fako cluster. It runs the CIS Kubernetes Benchmark checks to ensure the cluster follows security best practices. The service executes as a daily CronJob that performs comprehensive security scans, checking configurations of various Kubernetes components against industry standards. Results are saved with timestamps for audit trails and compliance reporting.
Key Features CIS Benchmark Compliance: Checks against Center for Internet Security standards Automated Scanning: Daily scheduled security assessments Comprehensive Coverage: Scans master and worker node configurations JSON Output: Machine-readable results for integration Historical Records: Timestamped results for trend analysis Host Access: Direct access to Kubernetes configuration files Multi-Component: Checks etcd, kubelet, API server, and more Results Processing: Automatic display of scan findings Architecture Components CronJob: Daily execution at 2 AM ServiceAccount: Permissions for scanning operations Main Container: kube-bench scanner with host access Results Processor: Monitors and displays scan results Storage: PersistentVolumeClaim for scan history Host Mounts: Access to Kubernetes system directories Resource Requirements Scanner: 256Mi RAM (request), 512Mi (limit) Processor: 64Mi RAM (request), 128Mi (limit) CPU: 100m-300m for scanner, 50m-100m for processor Storage: Persistent volume for results history Configuration Schedule CronJob Schedule: 0 2 * * * (daily at 2:00 AM) Concurrency Policy: Forbid (no overlapping scans) History Limits: 3 successful, 3 failed jobs Security Context hostPID: true (access host processes) privileged: true (full host access) Read-only mounts: All host paths mounted read-only Usage Manual Scan Execution Trigger an immediate security scan:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="pages">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="My New Hugo Site">
  <meta name="twitter:description" content="Kube-bench - Kubernetes Security Benchmark Scanner Overview Kube-bench is an automated security compliance scanner deployed in the Fako cluster. It runs the CIS Kubernetes Benchmark checks to ensure the cluster follows security best practices. The service executes as a daily CronJob that performs comprehensive security scans, checking configurations of various Kubernetes components against industry standards. Results are saved with timestamps for audit trails and compliance reporting.
Key Features CIS Benchmark Compliance: Checks against Center for Internet Security standards Automated Scanning: Daily scheduled security assessments Comprehensive Coverage: Scans master and worker node configurations JSON Output: Machine-readable results for integration Historical Records: Timestamped results for trend analysis Host Access: Direct access to Kubernetes configuration files Multi-Component: Checks etcd, kubelet, API server, and more Results Processing: Automatic display of scan findings Architecture Components CronJob: Daily execution at 2 AM ServiceAccount: Permissions for scanning operations Main Container: kube-bench scanner with host access Results Processor: Monitors and displays scan results Storage: PersistentVolumeClaim for scan history Host Mounts: Access to Kubernetes system directories Resource Requirements Scanner: 256Mi RAM (request), 512Mi (limit) Processor: 64Mi RAM (request), 128Mi (limit) CPU: 100m-300m for scanner, 50m-100m for processor Storage: Persistent volume for results history Configuration Schedule CronJob Schedule: 0 2 * * * (daily at 2:00 AM) Concurrency Policy: Forbid (no overlapping scans) History Limits: 3 successful, 3 failed jobs Security Context hostPID: true (access host processes) privileged: true (full host access) Read-only mounts: All host paths mounted read-only Usage Manual Scan Execution Trigger an immediate security scan:">


    

    <link rel="canonical" href="http://localhost:1313/pages/services/kube-bench/readme/">
    <link href="/style.min.e390ba7da26222f4dc42a349955d76dbbe44e5ce2535a43de5a70633a0a9ec3c.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
</head>
<body data-theme = "" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/pages/about/">
                        About
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/pages/projects/">
                        Projects
                    </a>
                    
                    <ul>
                        
                        <li>
                            <a class="menu-link "
                                href="/pages/projects/ollama/">
                                Ollama AI Server
                            </a>
                        </li>
                        
                        <li>
                            <a class="menu-link "
                                href="/pages/projects/open-webui/">
                                Open WebUI
                            </a>
                        </li>
                        
                        <li>
                            <a class="menu-link "
                                href="/pages/projects/n8n/">
                                N8N Automation
                            </a>
                        </li>
                        
                        <li>
                            <a class="menu-link "
                                href="/pages/projects/oura-dashboard/">
                                Oura Dashboard
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="">
                        Architecture
                    </a>
                    
                    <ul>
                        
                        <li>
                            <a class="menu-link "
                                href="/pages/architecture/overview/">
                                Overview
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title"></h1>
                
                
            </header>
            
            <div class="page-content">
                <h1 id="kube-bench---kubernetes-security-benchmark-scanner">Kube-bench - Kubernetes Security Benchmark Scanner</h1>
<h2 id="overview">Overview</h2>
<p>Kube-bench is an automated security compliance scanner deployed in the Fako cluster. It runs the CIS Kubernetes Benchmark checks to ensure the cluster follows security best practices. The service executes as a daily CronJob that performs comprehensive security scans, checking configurations of various Kubernetes components against industry standards. Results are saved with timestamps for audit trails and compliance reporting.</p>
<h2 id="key-features">Key Features</h2>
<ul>
<li><strong>CIS Benchmark Compliance</strong>: Checks against Center for Internet Security standards</li>
<li><strong>Automated Scanning</strong>: Daily scheduled security assessments</li>
<li><strong>Comprehensive Coverage</strong>: Scans master and worker node configurations</li>
<li><strong>JSON Output</strong>: Machine-readable results for integration</li>
<li><strong>Historical Records</strong>: Timestamped results for trend analysis</li>
<li><strong>Host Access</strong>: Direct access to Kubernetes configuration files</li>
<li><strong>Multi-Component</strong>: Checks etcd, kubelet, API server, and more</li>
<li><strong>Results Processing</strong>: Automatic display of scan findings</li>
</ul>
<h2 id="architecture">Architecture</h2>
<h3 id="components">Components</h3>
<ol>
<li><strong>CronJob</strong>: Daily execution at 2 AM</li>
<li><strong>ServiceAccount</strong>: Permissions for scanning operations</li>
<li><strong>Main Container</strong>: kube-bench scanner with host access</li>
<li><strong>Results Processor</strong>: Monitors and displays scan results</li>
<li><strong>Storage</strong>: PersistentVolumeClaim for scan history</li>
<li><strong>Host Mounts</strong>: Access to Kubernetes system directories</li>
</ol>
<h3 id="resource-requirements">Resource Requirements</h3>
<ul>
<li><strong>Scanner</strong>: 256Mi RAM (request), 512Mi (limit)</li>
<li><strong>Processor</strong>: 64Mi RAM (request), 128Mi (limit)</li>
<li><strong>CPU</strong>: 100m-300m for scanner, 50m-100m for processor</li>
<li><strong>Storage</strong>: Persistent volume for results history</li>
</ul>
<h2 id="configuration">Configuration</h2>
<h3 id="schedule">Schedule</h3>
<ul>
<li><strong>CronJob Schedule</strong>: <code>0 2 * * *</code> (daily at 2:00 AM)</li>
<li><strong>Concurrency Policy</strong>: <code>Forbid</code> (no overlapping scans)</li>
<li><strong>History Limits</strong>: 3 successful, 3 failed jobs</li>
</ul>
<h3 id="security-context">Security Context</h3>
<ul>
<li><strong>hostPID</strong>: <code>true</code> (access host processes)</li>
<li><strong>privileged</strong>: <code>true</code> (full host access)</li>
<li><strong>Read-only mounts</strong>: All host paths mounted read-only</li>
</ul>
<h2 id="usage">Usage</h2>
<h3 id="manual-scan-execution">Manual Scan Execution</h3>
<p>Trigger an immediate security scan:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl create job --from<span style="color:#f92672">=</span>cronjob/kube-bench-scanner manual-scan-<span style="color:#66d9ef">$(</span>date +%s<span style="color:#66d9ef">)</span> -n kube-bench
</span></span></code></pre></div><h3 id="viewing-scan-results">Viewing Scan Results</h3>
<p>Latest results:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># List result files</span>
</span></span><span style="display:flex;"><span>kubectl exec -n kube-bench deployment/results-viewer -- ls -la /results/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># View latest scan</span>
</span></span><span style="display:flex;"><span>kubectl exec -n kube-bench deployment/results-viewer -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  cat <span style="color:#66d9ef">$(</span>ls -t /results/kube-bench-results-*.json | head -1<span style="color:#66d9ef">)</span>
</span></span></code></pre></div><p>Copy results locally:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Get pod name</span>
</span></span><span style="display:flex;"><span>POD<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>kubectl get pods -n kube-bench -l app.kubernetes.io/name<span style="color:#f92672">=</span>kube-bench -o name | head -1<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Copy results</span>
</span></span><span style="display:flex;"><span>kubectl cp -n kube-bench $POD:/results ./kube-bench-results/
</span></span></code></pre></div><h3 id="monitoring-scans">Monitoring Scans</h3>
<p>Watch scan execution:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Watch job progress</span>
</span></span><span style="display:flex;"><span>kubectl logs -n kube-bench -l app.kubernetes.io/name<span style="color:#f92672">=</span>kube-bench -f
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Check job status</span>
</span></span><span style="display:flex;"><span>kubectl get jobs -n kube-bench --sort-by<span style="color:#f92672">=</span>.metadata.creationTimestamp
</span></span></code></pre></div><h2 id="scan-results">Scan Results</h2>
<h3 id="result-structure">Result Structure</h3>
<p>JSON output includes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Controls&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;text&#34;</span>: <span style="color:#e6db74">&#34;Control Plane Security Configuration&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;tests&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;1.1.1&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;desc&#34;</span>: <span style="color:#e6db74">&#34;Ensure API server pod specification permissions&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;audit&#34;</span>: <span style="color:#e6db74">&#34;stat -c %a /etc/kubernetes/manifests/kube-apiserver.yaml&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;pass&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;scored&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      ]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;Totals&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;total_pass&#34;</span>: <span style="color:#ae81ff">45</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;total_fail&#34;</span>: <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;total_warn&#34;</span>: <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;total_info&#34;</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="common-checks">Common Checks</h3>
<ol>
<li>
<p><strong>Control Plane Components</strong>:</p>
<ul>
<li>API Server configuration</li>
<li>Controller Manager settings</li>
<li>Scheduler security</li>
<li>etcd data encryption</li>
</ul>
</li>
<li>
<p><strong>Worker Node Security</strong>:</p>
<ul>
<li>Kubelet configuration</li>
<li>Kernel parameters</li>
<li>Network policies</li>
<li>Container runtime</li>
</ul>
</li>
<li>
<p><strong>Policies</strong>:</p>
<ul>
<li>RBAC settings</li>
<li>Pod Security Standards</li>
<li>Network segmentation</li>
<li>Admission controllers</li>
</ul>
</li>
</ol>
<h2 id="operations">Operations</h2>
<h3 id="analyzing-results">Analyzing Results</h3>
<p>Parse JSON for failures:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Extract failed checks</span>
</span></span><span style="display:flex;"><span>kubectl exec -n kube-bench deployment/results-viewer -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  jq <span style="color:#e6db74">&#39;.Controls[].tests[] | select(.pass == false)&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  /results/kube-bench-results-latest.json
</span></span></code></pre></div><p>Generate summary report:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Get totals</span>
</span></span><span style="display:flex;"><span>kubectl exec -n kube-bench deployment/results-viewer -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  jq <span style="color:#e6db74">&#39;.Totals&#39;</span> /results/kube-bench-results-latest.json
</span></span></code></pre></div><h3 id="scheduling-changes">Scheduling Changes</h3>
<p>Modify scan frequency:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Change to weekly (Sundays at 3 AM)</span>
</span></span><span style="display:flex;"><span>kubectl patch cronjob kube-bench-scanner -n kube-bench <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -p <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;schedule&#34;:&#34;0 3 * * 0&#34;}}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Change to twice daily</span>
</span></span><span style="display:flex;"><span>kubectl patch cronjob kube-bench-scanner -n kube-bench <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -p <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;schedule&#34;:&#34;0 2,14 * * *&#34;}}&#39;</span>
</span></span></code></pre></div><h3 id="result-retention">Result Retention</h3>
<p>Clean old results:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Delete results older than 30 days</span>
</span></span><span style="display:flex;"><span>kubectl exec -n kube-bench deployment/results-viewer -- <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  find /results -name <span style="color:#e6db74">&#34;*.json&#34;</span> -mtime +30 -delete
</span></span></code></pre></div><h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="scan-failures">Scan Failures</h3>
<ol>
<li><strong>Check job status</strong>:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl describe job -n kube-bench kube-bench-scanner-xxxxx
</span></span></code></pre></div><ol start="2">
<li><strong>View pod logs</strong>:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl logs -n kube-bench job/kube-bench-scanner-xxxxx -c kube-bench
</span></span></code></pre></div><ol start="3">
<li><strong>Common issues</strong>:
<ul>
<li>Missing host paths</li>
<li>Insufficient permissions</li>
<li>Node selector mismatch</li>
<li>PVC mount failures</li>
</ul>
</li>
</ol>
<h3 id="permission-issues">Permission Issues</h3>
<ol>
<li><strong>Verify ServiceAccount</strong>:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl get sa kube-bench -n kube-bench
</span></span><span style="display:flex;"><span>kubectl describe clusterrolebinding kube-bench
</span></span></code></pre></div><ol start="2">
<li><strong>Check host access</strong>:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Test host path access</span>
</span></span><span style="display:flex;"><span>kubectl exec -n kube-bench $POD -c kube-bench -- ls -la /etc/kubernetes/
</span></span></code></pre></div><h3 id="no-results-generated">No Results Generated</h3>
<ol>
<li><strong>Check result directory</strong>:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl exec -n kube-bench $POD -c results-processor -- ls -la /results/
</span></span></code></pre></div><ol start="2">
<li><strong>Verify write permissions</strong>:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl exec -n kube-bench $POD -c kube-bench -- touch /results/test.txt
</span></span></code></pre></div><h2 id="security-considerations">Security Considerations</h2>
<h3 id="privileged-access">Privileged Access</h3>
<ul>
<li>Requires privileged mode for host access</li>
<li>Uses hostPID to see all processes</li>
<li>Read-only mounts minimize risk</li>
</ul>
<h3 id="rbac-limitations">RBAC Limitations</h3>
<ul>
<li>ServiceAccount has minimal cluster permissions</li>
<li>No write access to configuration</li>
<li>Cannot modify cluster state</li>
</ul>
<h3 id="result-security">Result Security</h3>
<ul>
<li>Results may contain sensitive configuration details</li>
<li>Store in secure PVC</li>
<li>Limit access to kube-bench namespace</li>
</ul>
<h3 id="best-practices">Best Practices</h3>
<ol>
<li><strong>Review permissions</strong>: Audit RBAC regularly</li>
<li><strong>Secure results</strong>: Encrypt PVC if possible</li>
<li><strong>Monitor access</strong>: Log who views results</li>
<li><strong>Act on findings</strong>: Address failures promptly</li>
<li><strong>Version control</strong>: Track remediation changes</li>
</ol>
<h2 id="remediation">Remediation</h2>
<h3 id="common-fixes">Common Fixes</h3>
<h4 id="api-server-hardening">API Server Hardening</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Example: Enable audit logging</span>
</span></span><span style="display:flex;"><span>--audit-log-maxage<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span>--audit-log-maxbackup<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>--audit-log-maxsize<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>--audit-log-path<span style="color:#f92672">=</span>/var/log/audit.log
</span></span></code></pre></div><h4 id="kubelet-security">Kubelet Security</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># kubelet-config.yaml</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">kubelet.config.k8s.io/v1beta1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">KubeletConfiguration</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">authentication</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">anonymous</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">enabled</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">authorization</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">mode</span>: <span style="color:#ae81ff">Webhook</span>
</span></span></code></pre></div><h4 id="etcd-encryption">etcd Encryption</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># encryption-config.yaml</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apiserver.config.k8s.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">EncryptionConfiguration</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">secrets</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">providers</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">aescbc</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">keys</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">key1</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">secret</span>: <span style="color:#ae81ff">&lt;base64-encoded-secret&gt;</span>
</span></span></code></pre></div><h3 id="tracking-remediation">Tracking Remediation</h3>
<p>Create remediation records:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Save remediation notes</span>
</span></span><span style="display:flex;"><span>kubectl create configmap kube-bench-remediation <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --from-file<span style="color:#f92672">=</span>remediation-<span style="color:#66d9ef">$(</span>date +%Y%m%d<span style="color:#66d9ef">)</span>.md <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -n kube-bench
</span></span></code></pre></div><h2 id="integration-examples">Integration Examples</h2>
<h3 id="with-monitoring">With Monitoring</h3>
<p>Prometheus alerts:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># Alert on failed checks increasing</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">alert</span>: <span style="color:#ae81ff">KubeBenchFailuresIncreasing</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">expr</span>: <span style="color:#ae81ff">kube_bench_total_fail &gt; kube_bench_total_fail offset 1d</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;Security failures increased&#34;</span>
</span></span></code></pre></div><h3 id="cicd-pipeline">CI/CD Pipeline</h3>
<p>Pre-deployment check:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># .gitlab-ci.yml</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">security-scan</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">script</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">kubectl create job --from=cronjob/kube-bench-scanner ci-scan-$CI_JOB_ID</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">kubectl wait --for=condition=complete job/ci-scan-$CI_JOB_ID</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">kubectl logs job/ci-scan-$CI_JOB_ID</span>
</span></span></code></pre></div><h3 id="slack-notifications">Slack Notifications</h3>
<p>Add notification script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># In results-processor</span>
</span></span><span style="display:flex;"><span>FAILURES<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>jq <span style="color:#e6db74">&#39;.Totals.total_fail&#39;</span> $LATEST_FILE<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$FAILURES<span style="color:#e6db74">&#34;</span> -gt <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  curl -X POST $SLACK_WEBHOOK <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -d <span style="color:#e6db74">&#34;{\&#34;text\&#34;:\&#34;Kube-bench: </span>$FAILURES<span style="color:#e6db74"> security failures detected\&#34;}&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h2 id="monitoring">Monitoring</h2>
<h3 id="key-metrics">Key Metrics</h3>
<ul>
<li>Total pass/fail/warn counts</li>
<li>Scan execution time</li>
<li>Failure trends over time</li>
<li>Most common failures</li>
<li>Remediation progress</li>
</ul>
<h3 id="grafana-dashboard">Grafana Dashboard</h3>
<p>Essential panels:</p>
<ul>
<li>Security score over time</li>
<li>Failed checks by category</li>
<li>Remediation timeline</li>
<li>Compliance percentage</li>
</ul>
<h3 id="reports">Reports</h3>
<p>Generate compliance report:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># compliance-report.sh</span>
</span></span><span style="display:flex;"><span>LATEST<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ls -t /results/kube-bench-results-*.json | head -1<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;# Kubernetes Security Compliance Report&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Date: </span><span style="color:#66d9ef">$(</span>date<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;## Summary&#34;</span>
</span></span><span style="display:flex;"><span>jq -r <span style="color:#e6db74">&#39;.Totals | &#34;- Passed: \(.total_pass)\n- Failed: \(.total_fail)\n- Warnings: \(.total_warn)&#34;&#39;</span> $LATEST
</span></span></code></pre></div><h2 id="maintenance">Maintenance</h2>
<h3 id="regular-tasks">Regular Tasks</h3>
<ol>
<li>
<p><strong>Daily</strong>:</p>
<ul>
<li>Review scan results</li>
<li>Check for new failures</li>
</ul>
</li>
<li>
<p><strong>Weekly</strong>:</p>
<ul>
<li>Analyze failure trends</li>
<li>Plan remediation work</li>
<li>Clean old results</li>
</ul>
</li>
<li>
<p><strong>Monthly</strong>:</p>
<ul>
<li>Update kube-bench version</li>
<li>Review benchmark changes</li>
<li>Generate compliance reports</li>
</ul>
</li>
</ol>
<h3 id="version-updates">Version Updates</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Update to latest version</span>
</span></span><span style="display:flex;"><span>kubectl set image cronjob/kube-bench-scanner <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  kube-bench<span style="color:#f92672">=</span>aquasec/kube-bench:latest <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -n kube-bench
</span></span></code></pre></div><h3 id="benchmark-updates">Benchmark Updates</h3>
<p>Monitor CIS releases:</p>
<ul>
<li>Check for new benchmark versions</li>
<li>Review changed requirements</li>
<li>Update scan configuration</li>
</ul>
<h2 id="advanced-configuration">Advanced Configuration</h2>
<h3 id="custom-checks">Custom Checks</h3>
<p>Add custom security checks:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># custom-checks.yaml</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">groups</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">id</span>: <span style="color:#e6db74">&#34;custom&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">text</span>: <span style="color:#e6db74">&#34;Custom Security Checks&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">checks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">id</span>: <span style="color:#e6db74">&#34;C.1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">text</span>: <span style="color:#e6db74">&#34;Custom network policy check&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">audit</span>: <span style="color:#e6db74">&#34;kubectl get netpol --all-namespaces&#34;</span>
</span></span></code></pre></div><h3 id="selective-scanning">Selective Scanning</h3>
<p>Run specific check groups:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kube-bench --targets<span style="color:#f92672">=</span>master --check<span style="color:#f92672">=</span>1.1
</span></span></code></pre></div><h3 id="output-formats">Output Formats</h3>
<p>Different output options:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Plain text</span>
</span></span><span style="display:flex;"><span>kube-bench --outputfile /results/report.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># JUnit for CI</span>
</span></span><span style="display:flex;"><span>kube-bench --junit --outputfile /results/junit.xml
</span></span></code></pre></div><h2 id="future-improvements">Future Improvements</h2>
<ul>
<li><input disabled="" type="checkbox"> Implement automated remediation for safe fixes</li>
<li><input disabled="" type="checkbox"> Add trend analysis and reporting</li>
<li><input disabled="" type="checkbox"> Create web dashboard for results</li>
<li><input disabled="" type="checkbox"> Integrate with ticketing system</li>
<li><input disabled="" type="checkbox"> Add email notifications</li>
<li><input disabled="" type="checkbox"> Support multiple cluster scanning</li>
<li><input disabled="" type="checkbox"> Implement custom policy engine</li>
<li><input disabled="" type="checkbox"> Add compliance scoring system</li>
<li><input disabled="" type="checkbox"> Create remediation playbooks</li>
<li><input disabled="" type="checkbox"> Add cost of non-compliance metrics</li>
</ul>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
</div>
    <small class="footer_copyright">
        Â© 2025 .
        
    </small>
</footer>







    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
